<MacroButton@Button>:
    size: 100, 40
    size_hint: None, None
    on_press: self.parent.send(self.cmd)

<MacroToggleButton@ToggleButton>:
    size: 100, 40
    size_hint: None, None
    on_press: self.parent.send(self.oncmd if self.state == 'normal' else self.offcmd)
    check:''

<MacrosWidget>:
    orientation: 'tb-lr'
    spacing: 10, 10
    padding: 10, 10
    canvas.before:
        Color:
            rgba: 0.5, 0.5, 0.5, 1
        Rectangle:
            pos: self.pos
            size: self.size

    MacroToggleButton:
        id: power_but
        text: 'Power on' if self.state == 'normal' else 'Power off'
        oncmd: 'M81'
        offcmd: 'M80'
        check: 'switch psu'

    MacroToggleButton:
        id: fan_but
        text: 'Fan on' if self.state == 'normal' else 'Fan off'
        oncmd: 'M107'
        offcmd: 'M106 S255'
        check: 'switch fan'

    MacroButton:
        text: 'Settings'
        cmd: 'M503'

    MacroButton:
        text: 'Get Pos'
        cmd: 'get pos'

    MacroButton:
        text: 'CZ'
        cmd: 'G0 F15000 X0 Y0 Z0'

    MacroButton:
        text: 'C'
        cmd: 'G0 F15000 X0 Y0 Z0.2'

    MacroButton:
        text: 'T1'
        cmd: 'G0 F15000 X-102.85962 Y-59.3860 Z0.2'

    MacroButton:
        text: 'T2'
        cmd: 'G0 F15000 X102.85962 Y-59.3860 Z0.2'

    MacroButton:
        text: 'T3'
        cmd: 'G0 F15000 X0 Y118.7721 Z0.2'

    MacroButton:
        text: 'Kill'
        color: 1, 0, 0, 1
        cmd: '\x18' # ^X

    MacroButton:
        text: 'Clear Alarm'
        cmd: '$X'

